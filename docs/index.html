<html>
<head>
  <title>Hello</title>
  <script client="" defer="" src="https://unpkg.com/perlin-noise-3d@v0.5.4"></script>
  <style>
    @font-face {
      font-family: "Space Mono";
      src: url("/fonts/SpaceMono-Regular.ttf") format("truetype");
    }

    @font-face {
      font-family: "Space Mono";
      font-style: italic;
      src: url("/fonts/SpaceMono-Italic.ttf") format("truetype");
    }

    @font-face {
      font-family: "Miriam Libre";
      src: url("/fonts/MiriamLibre-Regular.ttf") format("truetype");
    }

    @font-face {
      font-family: "Miriam Libre";
      font-weight: bold;
      src: url("/fonts/MiriamLibre-Bold.ttf") format("truetype");
    }

    body {
      margin: 0;
      background-color: #111;
      color: #fff;
      font-family: "Space Mono", monaco, Consolas, Lucida Console, monospace;
    }

    :root {
      --bg-clr: #111;
      --clr0: #0ad591;
      --clr0-light: #52f8c1;
      --clr0-dark: #018b5d;
      --ease: cubic-bezier(0.6, 0, 0.2, 1);
    }

    a {
      color: var(--clr0, #fff);
    }

    a:visited {
      color: var(--clr0-dark, #fff);
    }
  </style>
  <style>
    .home-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 36px;
    }
  </style>
  <style>
    .home-grid-item {
      display: block;
      text-decoration: none;
      text-align: start;
      color: #fff;
      overflow: hidden;
    }

    .home-grid-item:visited {
      color: #eee;
    }

    .home-grid-image-container {
      width: 100%;
      min-height: 200px;
      aspect-ratio: 16 / 9;
      border-radius: 18px;
      background: var(--clr0);
      overflow: hidden;
      transition: background 1s;
    }

    .home-grid-item:hover .home-grid-image-container {
      background: #fff;
      transition: background 2s;
    }

    .home-grid-image {
      width: 101%;
      height: 101%;
      object-fit: cover;
      object-position: top;
      filter: contrast(0.8);
      transform: scale(1);
      transform-origin: 9px 9px;
      mix-blend-mode: darken;
      transition: filter 1s, transform 1s;
    }

    .home-grid-thumbalign-center .home-grid-image {
      object-position: center;
      transform-origin: center;
    }

    .home-grid-item:hover .home-grid-image {
      filter: contrast(1);
      transform: scale(1.1);
      transition: filter 1s, transform 2s;
    }

    .home-grid-title-wrap {
      position: relative;
      height: 0;
    }

    .home-grid-title-bar {
      position: absolute;
      bottom: 0;
      border-top-right-radius: 18px;
      background: var(--bg-clr);
    }

    .home-grid-title-content {
      position: relative;
      padding: 12px 24px 0 0;
    }

    .home-grid-title-content::before {
      content: "";
      position: absolute;
      left: 0;
      bottom: 100%;
      width: 18px;
      height: 36px;
      border-bottom-left-radius: 18px;
      box-shadow: 0 18px 0 var(--bg-clr);
    }

    .home-grid-title-content::after {
      content: "";
      position: absolute;
      left: 100%;
      bottom: 0;
      width: 36px;
      height: 18px;
      border-bottom-left-radius: 18px;
      box-shadow: -18px 0 0 var(--bg-clr);
    }

    .home-grid-title {
      font-size: 21px;
      font-style: italic;
      font-weight: bold;
    }

    .home-grid-posttitle {
      margin-top: 12px;
      font-size: 15px;
      font-style: italic;
      font-weight: bold;
      opacity: 0.8;
    }

    .home-grid-content {
      margin: 30px 0;
      line-height: 2;
    }
  </style>
  <style>
    .great-time-counter {
      display: none;
      position: fixed;
      top: 0;
      right: 0;
      font-size: 18px;
      pointer-events: none;
      transform-origin: top right;
      animation: great-time-counter-appear 0.6s both;
    }

    .great-time-counter.flash {
      background-color: #fff;
    }

    @keyframes great-time-counter-appear {
      from {
        opacity: 0;
        transform: scale(4);
      }
    }
  </style>
  <style>
    .great-time-trigger {
      text-decoration: underline;
      cursor: pointer;
      user-select: none;
    }
  </style>
  <style>
    .home-circle-icon-img {
      position: absolute;
      left: calc(50% - 2.5vh);
      top: calc(50% - 2.5vh);
      width: 5vh;
      height: 5vh;
      image-rendering: pixelated;
      filter: invert(1);
    }
  </style>
  <style>
    .curved {
      display: inline-block;
      width: 0;
    }
  </style>
  <style>
    .home-circle-text {
      position: relative;
      margin: 2vh;
      width: 36vh;
      height: 36vh;
      font-size: 3vh;
      font-style: italic;
      color: #fff;
      animation: home-circle-text-animation 7s cubic-bezier(0.785, 0.135, 0.15, 0.86) infinite;
    }

    @keyframes home-circle-text-animation {
      to {
        transform: rotate(-1turn);
      }
    }
  </style>
  <style>
    nebula-client>canvas {
      width: 100%;
      height: 100%;
    }
  </style>
  <style>
    .header {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 95vh;
    }

    .header-content {
      white-space: nowrap;
      min-width: 80vh;
    }

    .header-bg {
      position: relative;
      display: block;
      float: left;
      width: 40vh;
      height: 40vh;
      box-sizing: content-box;
      margin: 0vh 2vh;
      border-radius: 50%;
      background: #bf1852;
      shape-outside: circle(calc(50% + 1vh));
      text-align: initial;
      overflow: hidden;
    }

    .nebula {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
    }

    .intro-text {
      margin-top: 1.4vh;
      line-height: 1.8;
      font-size: 2.2vh;
      font-style: italic;
    }

    .ipa {
      font-size: 85%;
      font-style: normal;
    }

    .ipa>a,
    .ipa>a:visited {
      color: inherit;
    }

    @media (max-aspect-ratio: 4/5) {
      .header {
        height: 95vh;
      }

      .header-content {
        min-width: unset;
        text-align: center;
      }

      .header-bg {
        float: unset;
      }

      .intro-text {
        display: block;
      }
    }

    .section {
      max-width: 1200px;
      margin: 0 auto 180px;
      padding: 0 60px;
      font-size: 18px;
      text-align: center;
    }

    .section>p {
      margin: 30px 0;
      line-height: 2;
    }

    .section-title {
      margin: 0 0 36px;
      font-size: 24px;
      font-style: italic;
      font-weight: bold;
    }

    .about-section {
      max-width: 520px;
    }
  </style>
  <script>
    (() => {
      globalThis.BaseElement = createBaseElement(HTMLElement);

      const lifecycleListeners = Symbol("lifecycleListeners");

      function createBaseElement(superClass) {
        return class BaseElement extends superClass {
          constructor() {
            super();
            this[lifecycleListeners] = [];
          }
          connectedCallback() {
            this[lifecycleListeners].forEach((it) => it.connect());
          }
          disconnectedCallback() {
            this[lifecycleListeners].forEach((it) => it.disconnect());
          }

          /**
           * @param factory {() => () => void}
           */
          addLifecycleListener(factory) {
            let cleanup = () => {};
            const connect = () => (cleanup = factory());
            const disconnect = () => cleanup();

            this[lifecycleListeners].push({
              connect,
              disconnect
            });

            if (this.isConnected) {
              connect();
            }
          }

          /**
           * @param selector {string}
           */
          asyncQuerySelector(selector) {
            const obj = {
              exists: false,
              element: null,
            };

            obj.promise = new Promise((resolve) => {
              const observer = new MutationObserver(() => {
                obj.element = this.querySelector(selector);
                if (obj.element) {
                  resolve(obj.element);
                  obj.exists = true;
                  observer.disconnect();
                }
              });

              this.addLifecycleListener(() => {
                observer.observe(this, {
                  childList: true,
                  subtree: true
                });
                return () => observer.disconnect();
              });
            });

            return obj;
          }

          /**
           * @param target {Element}
           * @param event {string}
           * @param callback {Function}
           */
          aliveListener(target, event, callback) {
            this.addLifecycleListener(() => {
              target.addEventListener(event, callback);
              return () => target.removeEventListener(event, callback);
            });
          }

          /**
           * @param callbacks {object}
           * @param callbacks.show {Function}
           * @param callbacks.hide {Function}
           */
          visibilityListener({
            show,
            hide
          }) {
            let isShowing = false;

            const observer = new IntersectionObserver((entries) => {
              for (const entry of entries) {
                if (entry.target !== this) continue;
                if (isShowing !== entry.isIntersecting) {
                  isShowing = entry.isIntersecting;
                  if (isShowing) {
                    show();
                  } else {
                    hide();
                  }
                }
              }
            });

            this.addLifecycleListener(() => {
              isShowing = false;
              observer.observe(this);
              return () => observer.disconnect();
            });
          }
        };
      }

      window.mousePosition = {
        x: 0,
        y: 0
      };
      document.addEventListener(
        "DOMContentLoaded",
        () => {
          document.body.addEventListener("mousemove", (event) => {
            window.mousePosition.x = event.clientX;
            window.mousePosition.y = event.clientY;
          });
        }, {
          once: true
        }
      );
    })();
  </script>
  <script>
    customElements.define(
      "nebula-client",
      class Nebula extends BaseElement {
        constructor() {
          super();

          this.asyncCanvas = this.asyncQuerySelector("canvas");
          this.context = null;
          this.noise = null;

          this.size = 30;
          this.palette = ["#ffffff"];

          this.cellWidth = 1; // placeholder
          this.cellHeight = 1; // placeholder

          this.lastT = 0;
          this.startT = 0;

          this.isVisible = true;
          this.visibilityListener({
            show: () => {
              this.isVisible = true;
              if (this.isConnected) this.loop();
            },
            hide: () => (this.isVisible = false),
          });
        }

        connectedCallback() {
          super.connectedCallback();

          const paletteAttr = this.getAttribute("palette");
          if (paletteAttr) {
            this.palette = paletteAttr.split(" ");
          }

          if (this.isVisible) this.loop();
        }

        async loop() {
          if (!this.isConnected && !this.isVisible) return;

          const canvas =
            this.asyncCanvas.value ?? (await this.asyncCanvas.promise);

          // initialize
          if (!this.context) {
            this.cellWidth = Math.ceil(canvas.offsetWidth / this.size);
            this.cellHeight = Math.ceil(canvas.offsetHeight / this.size);
            canvas.width = this.size;
            canvas.height = this.size;
            canvas.style.filter += ` blur(${this.cellWidth * 1.25}px)`;
            this.context = canvas.getContext("2d");
          }

          requestAnimationFrame(() => this.loop());

          if (typeof perlinNoise3d === "undefined") return;
          if (!this.noise) {
            this.noise = initNoise();
            this.startT = getT();
          }

          this.draw(canvas, this.context);
        }

        /**
         * @param canvas {HTMLCanvasElement}
         * @param context {CanvasRenderingContext2D}
         */
        draw(canvas, context) {
          const t = getT();
          if (t <= this.lastT) return;
          this.lastT = t;

          const initTime = 8;
          const alpha =
            t <= this.startT + initTime ?
            1 * ((this.startT + initTime - t) / initTime) :
            0.016;

          const {
            noise,
            size,
            palette,
            cellWidth,
            cellHeight
          } = this;
          const halfGridSize = size / 2;

          let mouseCell = null;
          // mousePosition from lib/common
          if (window.mousePosition) {
            const {
              x,
              y
            } = window.mousePosition;
            const bounds = canvas.getBoundingClientRect();
            if (
              bounds.left < x &&
              x < bounds.right &&
              bounds.top < y &&
              y < bounds.bottom
            ) {
              mouseCell = {
                x: (x - bounds.x) / cellWidth,
                y: (y - bounds.y) / cellHeight,
              };
            }
          }

          const paletteLength = palette.length;
          const xScale = 0.14 + Math.sin(t * 0.03) * 0.06;
          const yScale = 0.14 + Math.cos(t * 0.05) * 0.06;

          for (let i = 0; i < size; i++) {
            for (let j = 0; j < size; j++) {
              const xy = [
                1000 + (i - halfGridSize) * xScale + Math.sin(t * 0.01) * 2,
                1000 + (j - halfGridSize) * yScale + Math.cos(t * 0.007) * 2,
              ];
              const p1 = noise.get(...xy, t * 0.03);
              const p2 = noise.get(...xy, t * 0.03 + 0.5);
              // for some reason, this library's output range is [0,0.5], so this averages to [0,1]
              const p = p1 + p2;

              const mouseProximity =
                mouseCell == null ?
                0 :
                1 - sigmoid(Math.hypot(i - mouseCell.x, j - mouseCell.y) - 4);

              const paletteIndex = Math.floor(paletteLength * p);

              const rgb = palette[paletteIndex];
              const a = Math.floor(Math.max(alpha, mouseProximity) * 255)
                .toString(16)
                .padStart(2, "0");

              context.fillStyle = `${rgb}${a}`;
              context.fillRect(i, j, 1, 1);
            }
          }
        }
      }
    );

    function getT() {
      return Math.floor((Date.now() * 30) / 1000);
    }

    function initNoise() {
      const noise = new perlinNoise3d();
      noise.perlin_octaves = 1; // ?? defaults
      noise.perlin_amp_falloff = 1;
      return noise;
    }

    function sigmoid(x) {
      return 1 / (1 + Math.exp(-x));
    }
  </script>
</head>


<body>


  <div class="header">
    <div class="header-content">
      <div class="header-bg">


        <nebula-client class="nebula" palette="#e79907 #bf1852 #4d4aff #0ad591">
          <canvas style="filter: contrast(1.5)">
          </canvas></nebula-client>
        <div class="home-circle-text">
          <span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(-108.75deg); transform-origin: 0.5ch 18vh">W</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(-101.25deg); transform-origin: 0.5ch 18vh">e</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(-93.75deg); transform-origin: 0.5ch 18vh">l</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(-86.25deg); transform-origin: 0.5ch 18vh">c</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(-78.75deg); transform-origin: 0.5ch 18vh">o</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(-71.25deg); transform-origin: 0.5ch 18vh">m</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(-63.75deg); transform-origin: 0.5ch 18vh">e</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(-56.25deg); transform-origin: 0.5ch 18vh"> </span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(-48.75deg); transform-origin: 0.5ch 18vh">t</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(-41.25deg); transform-origin: 0.5ch 18vh">o</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(-33.75deg); transform-origin: 0.5ch 18vh"> </span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(-26.25deg); transform-origin: 0.5ch 18vh">m</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(-18.75deg); transform-origin: 0.5ch 18vh">y</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(-11.25deg); transform-origin: 0.5ch 18vh"> </span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(-3.75deg); transform-origin: 0.5ch 18vh">p</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(3.75deg); transform-origin: 0.5ch 18vh">e</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(11.25deg); transform-origin: 0.5ch 18vh">r</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(18.75deg); transform-origin: 0.5ch 18vh">s</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(26.25deg); transform-origin: 0.5ch 18vh">o</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(33.75deg); transform-origin: 0.5ch 18vh">n</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(41.25deg); transform-origin: 0.5ch 18vh">a</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(48.75deg); transform-origin: 0.5ch 18vh">l</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(56.25deg); transform-origin: 0.5ch 18vh"> </span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(63.75deg); transform-origin: 0.5ch 18vh">w</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(71.25deg); transform-origin: 0.5ch 18vh">e</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(78.75deg); transform-origin: 0.5ch 18vh">b</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(86.25deg); transform-origin: 0.5ch 18vh">s</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(93.75deg); transform-origin: 0.5ch 18vh">i</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(101.25deg); transform-origin: 0.5ch 18vh">t</span><span class="curved" style="transform: translateX(calc(18vh - 0.5ch)) rotate(108.75deg); transform-origin: 0.5ch 18vh">e</span>
        </div>
        <img class="home-circle-icon home-circle-icon-img" src="home/icons/tada.png">
      </div>

      <span class="intro-text">
        <span id="greeting"><span id="home-greeting">hello!</span></span>
        <br>
        I'm Lean
        <span class="ipa">[<a target="_blank" href="http://ipa-reader.xyz/?text=li%CB%88%C9%99n">liˈən</a>]</span>,
        <br>
        software engineer
        <br>
        who likes making stuff,
        <br>
        code, art, and music.
        <br>
        <br>
        Nice to meet you.
        <br>
        Please, <span class="great-time-trigger" onclick="haveAGreatTime()">have a great time.</span>
      </span>
    </div>
  </div>

  <div id="great-time-counter" class="great-time-counter">
    you now have <span id="great-time-num">0</span> great time(s)
  </div>

  <section class="section about-section">
    <h2 class="section-title">About me</h2>
    <p>My name is Lean Rada.</p>
    <p>I want to build good things using technology.</p>
    <p>
      My interests are programming, interactive things, procedural animations,
      algorithms, art, music theory, games, and tech.
    </p>
  </section>

  <section class="section">
    <h2 class="section-title">Some things I've made</h2>
    <div class="home-grid">

      <a class="home-grid-item home-grid-thumbalign-center" href="/projects/wikawik/">
        <div class="home-grid-image-container">
          <img class="home-grid-image" src="projects/wikawik/media/wikawik.jpg" alt="" srcset="projects/wikawik/media/wikawik_600.jpg 600w" sizes=" 600px">
        </div>
        <div class="home-grid-title-wrap">
          <div class="home-grid-title-bar">
            <div class="home-grid-title-content">
              <div class="home-grid-title">Wikawik</div>
              <div class="home-grid-posttitle">(2020) Interactive language map</div>
            </div>
          </div>
        </div>
        <div class="home-grid-content">
          A webapp that shows the diversity of languages in the Philippines.
          Learn about the local languages. Listen to local songs and other
          media. Made in vanilla JS with D3.js. Passion project.
        </div>
      </a>
      <a class="home-grid-item home-grid-thumbalign-center" href="/projects/hypertangram/">
        <div class="home-grid-image-container">
          <img class="home-grid-image" src="projects/hypertangram/media/hypertangram_0.jpg" alt="" srcset="projects/hypertangram/media/hypertangram_0_600.jpg 600w" sizes=" 600px">
        </div>
        <div class="home-grid-title-wrap">
          <div class="home-grid-title-bar">
            <div class="home-grid-title-content">
              <div class="home-grid-title">Hypertangram</div>
              <div class="home-grid-posttitle">(2018) Geometric puzzle game</div>
            </div>
          </div>
        </div>
        <div class="home-grid-content">
          A puzzle game about fitting shapes together. Just like tangram, but
          the pieces are resizable, allowing for more open-ended solutions. Runs
          on Android. Supports multi-touch interaction! Hobby project.
        </div>
      </a>
      <a class="home-grid-item home-grid-thumbalign-default" href="/projects/canva-photo-editor/">
        <div class="home-grid-image-container">
          <img class="home-grid-image" src="projects/canva-photo-editor/img/canvaphotoeditor_1.jpg" alt="" srcset="projects/canva-photo-editor/img/canvaphotoeditor_1_600.jpg 600w" sizes=" 600px">
        </div>
        <div class="home-grid-title-wrap">
          <div class="home-grid-title-bar">
            <div class="home-grid-title-content">
              <div class="home-grid-title">Photo Editor</div>
              <div class="home-grid-posttitle">(2019) Online image editing</div>
            </div>
          </div>
        </div>
        <div class="home-grid-content">
          A webapp for quick photo edits. Apply filters. Adjust contrast.
          Sharpen, blur. Crop, rotate, and resize. Made with React, Canvas API,
          and WebGL. Project at Canva.
        </div>
      </a>
      <a class="home-grid-item home-grid-thumbalign-center" href="/projects/dimensions/">
        <div class="home-grid-image-container">
          <img class="home-grid-image" src="projects/dimensions/media/dimensions_0.jpg" alt="" srcset="projects/dimensions/media/dimensions_0_600.jpg 600w" sizes=" 600px">
        </div>
        <div class="home-grid-title-wrap">
          <div class="home-grid-title-bar">
            <div class="home-grid-title-content">
              <div class="home-grid-title">Dimensions</div>
              <div class="home-grid-posttitle">(2019) Augmented reality generative art</div>
            </div>
          </div>
        </div>
        <div class="home-grid-content">
          Generative art with extra dimensions. Web-based, uses vanilla js for
          the generator and a three.js-based mobile webapp for the AR
          experience. Made for a company event.
        </div>
      </a>

    </div>
  </section>

  <script>
    (() => {
      const container = document.getElementById("great-time-counter");
      const num = document.getElementById("great-time-num");

      let greatTimes = 0;

      window.haveAGreatTime = function() {
        greatTimes++;
        num.innerText = greatTimes;
        if (greatTimes === 1) {
          container.style.display = "block";
        } else {
          container.classList.add("flash");
          setTimeout(() => container.classList.remove("flash"), 34);
        }
      };
    })();
  </script>
  <script>
    const greeting = document.getElementById("greeting");

    let text = greeting.textContent;
    // todo: more?
    text =
      pick("Hello!", "What's up ↑", "Hi there →", "Hey there →");
    greeting.textContent = text;

    function pick(...choices) {
      return choices[Math.floor(Math.random() * choices.length)];
    }
  </script>
</body>
</html>